# 공연 이미지 업로드 가이드 (MinIO)

## 개정이력

| 버전 | 일자 | 작성자 | 내용 |
|------|------|--------|------|
| 1.0 | 2025-12-29 | Gemini | 초기 가이드 작성 |

---

이 문서는 Smarter Store API 서버의 공연 등록 시 MinIO를 활용한 이미지 업로드 방법을 안내합니다.

## 1. 개요

**핵심 흐름:**
1. 공연 생성 API 호출 → 공연 ID 획득
2. 이미지 업로드 API 호출 → `mainImageUrl` 자동 업데이트

## 2. 사전 준비 (MinIO)

- **API 엔드포인트:** `http://localhost:9000`
- **콘솔 UI:** `http://localhost:9001`
- **버킷명:** `smarter-store`

## 3. API 엔드포인트

| 메서드 | URL | 설명 |
|--------|-----|------|
| POST | `/api/performances` | 공연 생성 (이미지 제외 정보 입력) |
| POST | `/api/v1/performances/{performanceId}/images` | 이미지 업로드 (THUMBNAIL 타입 시 자동 매핑) |

## 4. 이미지 처리 흐름

1. **클라이언트**: 이미지 파일 및 `imageType` 전송.
2. **서버**: 파일 유효성 검사 (JPEG, PNG 등, 최대 10MB).
3. **서버**: MinIO 업로드 및 URL 생성.
4. **서버**: `imageType`이 `THUMBNAIL`인 경우 공연 엔티티의 `mainImageUrl` 즉시 업데이트.

## 5. 오류 처리

- `400`: 허용되지 않는 파일 형식 또는 크기 초과.
- `403`: 권한 없음 (ADMIN 전용).
- `404`: 공연 정보를 찾을 수 없음.
- `500`: 스토리지 서버 연결 오류.