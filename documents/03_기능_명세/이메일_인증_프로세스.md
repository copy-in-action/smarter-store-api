# 이메일 인증 프로세스 가이드

## 개정이력

| 버전 | 일자 | 작성자 | 내용 |
|------|------|--------|------|
| 1.0 | 2025-12-29 | Gemini | 초기 가이드 작성 |

---

이 문서는 Smarter Store API에 구현된 이메일 인증 프로세스를 설명합니다. 회원가입 시 이메일 유효성 확인이 주 목적입니다.

## 1. 개요

**Smarter Store API**의 이메일 인증은 회원가입 과정의 일부로, 사용자가 제공한 **이메일 주소의 유효성** 및 **소유권**을 확인하는 중요한 절차입니다.

## 2. 프로세스 참여자

*   **사용자 (User):** 이메일 인증 요청 및 OTP 확인 주체.
*   **API 서버 (API Server):** OTP 생성, 저장, 유효성 검사 및 최종 회원가입 처리.
*   **이메일 서비스 (Email Service):** OTP 인증 이메일 발송.
*   **데이터베이스 (Database):** 사용자 및 토큰 정보 저장.

## 3. 프로세스 흐름

### 3.1. 1단계: OTP 요청 및 확인
1.  **OTP 요청**: `POST /api/auth/email-verification/request` 호출. 서버는 6자리 OTP를 생성하여 이메일 발송.
2.  **OTP 확인**: `POST /api/auth/confirm-otp` 호출. 서버는 토큰의 만료 여부 및 일치 여부 확인 후 승인 상태(`isConfirmed=true`)로 변경.

### 3.2. 2단계: 회원가입
1.  **회원가입 요청**: `POST /api/auth/signup` 호출. 승인된 토큰 존재 시 최종 가입 처리 및 토큰 삭제.

## 4. 주요 API 엔드포인트

*   `POST /api/auth/email-verification/request`: OTP 요청
*   `POST /api/auth/confirm-otp`: OTP 확인
*   `POST /api/auth/signup`: 최종 회원가입

## 5. 오류 처리

*   `EMAIL_ALREADY_EXISTS`: 이미 가입된 이메일.
*   `INVALID_EMAIL_VERIFICATION_TOKEN`: 유효하지 않은 OTP.
*   `EXPIRED_EMAIL_VERIFICATION_TOKEN`: 만료된 OTP (5분 제한).
*   `EMAIL_NOT_VERIFIED`: 인증되지 않은 이메일로 가입 시도.